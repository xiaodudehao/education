<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>学习成绩统计</title>
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../package/bootstrapvalidator-master/dist/css/bootstrapValidator.min.css">
    <!-- 提示框样式 -->
    <link href="../lib/toastr/toastr.min.css" type="text/css" rel="stylesheet">
    <!--  对话框样式  -->
    <link href="../lib/confirm/jquery-confirm.min.css" type="text/css" rel="stylesheet">
    <!-- rwb分页的样式 -->
    <link rel="stylesheet" href="../css/public/rwbpage.css">
    <link rel="stylesheet" href="../css/repositoryfile.css">


</head>

<body>
<div class="maincontent">
    <!-- 头部导航栏开始 -->
    <div class="header">
        <div class="banxin">
            <img src="../img/未标题-10.png" class="logo" alt="">
            <ul>
                <li><a href="">首页</a></li>
                <li><a href="">课程</a></li>
                <li><a href="">院校</a></li>
                <li><a href="">立体教材</a></li>
            </ul>
            <div class="search">
                <img class="searchicon" src="../img/未标题-1.png" ></img>
                <input type="text" placeholder="搜索课程或学校">
            </div>
            <div class="login">
                <a href="">
                    <img class="loginicon" src="../img/未标题-2.png"></img>
                </a>
                <!-- 这里的模态框用js实现 -->
                <div class="register" data-toggle="modal" data-target="#myModal">注册</div>
                <!-- 要显示新模态框，修改data-target中的ID就可以了 -->
                <div class="log" data-toggle="modal" data-target="#myModal1">登录</div>
            </div>
        </div>
    </div>
    <!-- 头部导航栏结束 -->
    <!--  中间内容开始  -->
    <div class="tt_content">
        <!--  左边内容  -->
        <div class="tt_content_left">
            <img src="../images/kecheng1.png">
            <div class="tt_content_leftmenu">
                <a href="" class="introduction_href">课程简介</a>
                <a class="teacher_href" href="">教师团队</a>
                <a class="course_resources active" href="" >课程资源</a>
                <a class="catalog_href" href="">课程目录</a>
                <a class="announcement_href" href="">系统公告</a>
                <a class="criteria_href" href="">评分表准</a>
                <a class="test_href" href="">测验/考试</a>
                <a class="course_discussion" href="">讨论区</a>
                <a class="course_class" href="">班级</a>
                <a class="course_student" href="">学生</a>
                <a class="course_sum" href="">课程统计</a>
                <a class="course_study_sum" href="">学习统计</a>
            </div>
        </div>
        <!--  右边内容  -->
        <div class="tt_content_right">
            <div class="tt_content_right_title">
                文件
            </div>
            <!--  主要内容  -->
            <div class="tt_team">
                <div class="clearfix ">
                    <div class="sort">
                        排序
                        <ul>
                            <li class="asc">升序</li>
                            <li class="desc">降序</li>
                        </ul>
                    </div>
                </div>
                <div class="filebox clearfix">
                    <div class="courseicon">
                        <div class="add">+</div>
                        <div class="addtext">本地添加</div>
                        <input type="file" class="addfile">
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                    <div href="" class="courseimg">
                        <div class="courseshowbox">
                            <img class="courseshow" src="../img/未标题-7.png" alt="">
                            <div class="select">
                                <div class="delet">删除</div>
                                <div class="update">重命名</div>
                                <div class="down">下载</div>
                            </div>
                        </div>
                        <div class="imgtext">
                            涂装工艺
                        </div>
                    </div>
                </div>
                <!--  分页  -->
                <div class="page_area">
                    <ul id="page"></ul>
                </div>
            </div>
        </div>
    </div>
    <!--  中间内容结束  -->
    <!-- 底部开始 -->
    <div class="footercontenter">
        <div class="footer">
            <div class="banxin footerbanxin">
                <div class="footercenter">
                    沪公网备案  *****号&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COPYRIGHT © 2008-2012 兰鸿科技
                </div>
            </div>
        </div>
    </div>
    <!-- 底部结束 -->
</div>
<!-- 注册模态框开始 -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="registertitle">
                用户注册
            </div>
            <form id="registerform" name="register"  class="registerform" action="">
                <div class="form-group">

                    <input  name="telephoneemail" placeholder="输入邮箱或手机号" class="telephone" type="text">
                </div>
                <div class="form-group">

                    <input name="username" placeholder="输入用户名" class="username" type="text">
                </div>
                <div class="form-group">

                    <input id="password" name="password" placeholder="输入密码" class="password" type="password">
                </div>
                <!-- <div class="nameexist">该用户名已存在</div> -->
                <div class="registerbutton">立即注册</div>
                <div class="elseregister">
                    <span>其它登录方式</span>
                    <a href=""><img src="../img/qq.png" alt=""></a>
                    <a href=""><img src="../img/weixin.png" alt=""></a>
                    <a href=""><img  src="../img/xinlang.png" alt=""></a>
                    <div class="nameexist">该用户名已存在</div>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- 注册模态框结束 -->
<!-- 登录模态框开始 -->
<div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="registertitle">
                用户登录
            </div>
            <form class="registerform loginform" id="loginform" action="">
                <div class="form-group">
                    <input  placeholder="输入用户名" name="username" class="telephone" type="text">
                </div>
                <div class="form-group">
                    <input placeholder="输入密码" name="password" class="username" type="password">
                </div>

                <div class="codefather clearfix">
                    <input  placeholder="输入验证码" name="code" class="code" type="text">
                    <img src="../img/code.png" class="codeimg"></img>
                    <div class="check">换一张</div>
                    <div class="codeerr uperr">
                        ⓧ 用户名或密码错误
                    </div>
                    <div class="codeerr cerr">
                        ⓧ 验证码错误
                    </div>
                </div>

                <div class="loginbutton">立即登录</div>
                <div class="else">

                    <div class="linkregister">注册</div>
                    <div class="forget">忘记密码</div>
                    <span>其它登录方式</span>


                    <a href=""><img src="../img/qq.png" alt=""></a>
                    <a href=""> <img src="../img/weixin.png" alt=""></a>
                    <a href=""><img  src="../img/xinlang.png" alt=""></a>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- 修改模态框开始 -->
<div class="modal fade" id="new_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content" style="width: 100%; height: auto">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">修改文件名</h4>
            </div>
            <!-- 由于form表单有刷新页面的副作用，所以用div代替 -->
            <div class="form-horizontal adminex-form" id="new_form">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="col-sm-3 col-sm-offset-1 control-label">新文件名</label>
                        <div class="col-sm-6">
                            <input class="form-control addclassname"  type="text" placeholder="请输入新文件名" />
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <input type="submit" class="btn btn-primary saveclass" value="保存" />
                </div>
            </div>

            <!-- <form  action="javascript: add_teacher()"  >
            </form> -->

        </div>
    </div>
</div>
<!-- 修改模态框结束 -->
<!-- 添加到章节开始 -->
<div class="modal fade" id="addasection" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content" style="width: 100%; height: auto">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">添加章节</h4>
            </div>
            <!-- 由于form表单有刷新页面的副作用，所以用div代替 -->
            <div class="form-horizontal adminex-form" id="new_form">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="col-sm-3 col-sm-offset-1 control-label">项目</label>
                        <select class="col-sm-6 selectone">
                            <!-- <option value="">1111111</option>
                            <option value="">2222222</option> -->
                            <!-- <input class="form-control addclassname"  type="text" placeholder="请输入新文件名" /> -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 col-sm-offset-1 control-label">任务</label>
                        <!-- <div class="col-sm-6">
                            <input class="form-control addclassname"  type="text" placeholder="请输入新文件名" />
                        </div> -->
                        <select class="col-sm-6 selecttwo">
                            <!-- <option value="">1111111</option>
                            <option value="">2222222</option> -->
                            <!-- <input class="form-control addclassname"  type="text" placeholder="请输入新文件名" /> -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 col-sm-offset-1 control-label">操作</label>
                        <!-- <div class="col-sm-6">
                            <input class="form-control addclassname"  type="text" placeholder="请输入新文件名" />
                        </div> -->
                        <select class="col-sm-6 selectthree">
                            <!-- <option value="">1111111</option>
                            <option value="">2222222</option> -->
                            <!-- <input class="form-control addclassname"  type="text" placeholder="请输入新文件名" /> -->
                        </select>
                    </div>




                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <input type="submit" class="btn btn-primary addsection" value="保存" />
                </div>
            </div>

            <!-- <form  action="javascript: add_teacher()"  >
            </form> -->

        </div>
    </div>
</div>
<!-- 添加到章节结束 -->


<!-- 在ajax请求未返回数据前执行的动画 -->
<div class="modal fade" id="loadingModal" data-backdrop="static">
    <div style="width: 200px;height:20px; z-index: 20000; position: absolute; text-align: center; left: 50%; top: 50%;margin-left:-100px;margin-top:-10px">
        <div class="progress progress-striped active" style="margin-bottom: 0;">
            <div class="progress-bar" style="width: 100%;"></div>
        </div>
        <h5 style="color: white; font-weight: bold">努力加载中...</h5>
    </div>
</div>






</body>

<script src="../node_modules/echarts/dist/echarts.common.js" ></script>
<script src="../node_modules/jquery/dist/jquery.min.js" ></script>
<script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="../package/bootstrapvalidator-master/dist/js/bootstrapValidator.min.js" ></script>
<script src="../js/public.js" ></script>
<script src="../package/jquerypage.js" ></script>

<!-- 分页器 -->
<script src="../lib/bootstrap-paginator.js"></script>
<!-- 提示框插件 -->
<script src="../lib/toastr/toastr.min.js"></script>
<!-- 对话框样式 -->
<script src="../lib/confirm/jquery-confirm.min.js"></script>

<!--<script src="../js/teacher_team.js" ></script>-->
<script type="text/javascript">
    $(function(){



        // 模态框居中
        modalCenter('#myModal')
        modalCenter('#myModal1')
        modalCenter('#new_modal')
        modalCenter('#addasection')
        var fileid;
        var clas=getSearch("class");
        var site;
        var sectionid;
        // 页码
        var page = 1;
        // 排序
        var sort = "DESC";
        // 存储上一次的页码
        var pagedata;


        var cid = 1;
        //提示框初始化，toast-top-center表示提示框的位置
        toastr.options = {
            positionClass: 'toast-top-center', // 提示框位置
            closeButton: true  // 是否显示关闭按钮
        }
        
        function add_teacher(){
            console.log(333333333333333);
            
        }
        // 原生ajax发送头像信息开始
        var xhr;
            function createXMLHttpRequest() {
                if (window.ActiveXObject) {
                    xhr = new ActiveXObject("Microsoft.XMLHTTP");
                } else if (window.XMLHttpRequest) {
                    xhr = new XMLHttpRequest();
                }
            }
            function UpladFile(addurl) {
                console.log( document.getElementById("filebtn") );
                
                var fileObj = document.getElementById("filebtn").files[0];
                console.log(fileObj);
                // "http://192.168.1.110/lanhong/index.php/Admin/Resource/text"
                var FileController = addurl;
                var form = new FormData();
                form.append("cid", cid);
                // form.append("name", "word文档");
                form.append("myFile", fileObj);
                createXMLHttpRequest();
                xhr.onreadystatechange = handleStateChange;
                xhr.open("post", FileController, true);
                console.log('内容',form);
                xhr.send(form);
            }
            function handleStateChange() {
                if (xhr.readyState == 4) {
                    if (xhr.status == 200 || xhr.status == 0) {
                        // 重新渲染页面
                        select_announce(page,sort)
                        // history.go(0)
                        // var result = xhr.responseText;
                        // var json = eval("(" + result + ")");
                        // alert('图片链接:\n' + json.file);
                    }
                }
            }
        // 原生ajax发送头像信息结束
        



        if(clas == 1){
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了文本文件",this);
                UpladFile(HTTP_URL+"Resource/text")
            })
        }else if(clas == 2){
            //图像
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了图像文件",this);
                UpladFile(HTTP_URL+"Resource/photo")
            })
        }else if(clas == 3){
            //音频
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了音频文件",this);
                UpladFile(HTTP_URL+"Resource/audio")
            })
            // 拼接跳转地址
            $(".tt_team").on("click",".courseshow",function(){
            // $(".courseshow").on("click",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                fileid = $(this).data("savename");
                console.log(fileid );
                window.location.href = 'repositorypreview.html?vid='+fileid+'&clas='+clas;
            })
        }else if(clas == 4){
            // 视频
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了视频文件",this);
                UpladFile(HTTP_URL+"Resource/vedio")
            })
            $(".tt_team").on("click",".courseshow",function(){
            // $(".courseshow").on("click",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                fileid = $(this).data("savename");
                console.log(fileid );
                window.location.href = 'repositorypreview.html?vid='+fileid+'&clas='+clas;
            })
        }else if(clas == 5){
            // 动画
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了动画文件",this);
                UpladFile(HTTP_URL+"Resource/cartoon")
            })                        
        }else if(clas == 6){
            // 虚拟仿真
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了虚拟仿真文件",this);
                UpladFile(HTTP_URL+"Resource/dummy")
            })  
        }else if(clas == 7){
            // 电子课件
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了电子课件文件",this);
                UpladFile(HTTP_URL+"Resource/eclass")
            })  
        }else if(clas == 8){
            //网页
        // 添加文件
        $(".tt_team").on("change",".addfile",function(){
            // 要重新渲染的页码
            page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了网页文件",this);
                UpladFile(HTTP_URL+"Resource/webpage")
            })  
        }else if(clas == 9){
            // 图书
            // 添加文件
            $(".tt_team").on("change",".addfile",function(){
                // 要重新渲染的页码
                page = 1;
                // // 要重新渲染的排序
                // sort = sl;
                console.log("当选择了图书文件",this);
                UpladFile(HTTP_URL+"Resource/ebook")
            })  
        }

        



        //获取当前课程章节的数据
        function courseclass(cid,url){
            $.ajax({
                type:"post",
                url: HTTP_URL+url,
                dataType:"json",
                data: {cid: cid},
                success:function(data){
                    console.log("当前课程",data);
                    if(data != null && data != false){
                        // html字符串
                        var str = "";
                        var str1 ="";
                        var str2 =""
                        // 保存当前选中的下标;
                        var oneval;
                        var twoval;
                        var thrval;
                            // 如果直接单击第二个框，因为没有oneval值会报错
                            oneval = 0;
                        //每个输入框里的id
                        var id;
                        // 获取默认的id
    
                        // 初始化
                        // 渲染第一个输入框
                        for(var i=0;i<data.length;i++){
                        str += '<option value="'+ i +'" >'+ data[i].courseware +'</option>'
                        }
                        $(".selectone").html(str)
                    
                        // 判断并渲染第二个输入框
                        if(data[0].children == undefined){
                            // 如果没有第二级就渲染“无”，第三级也渲染无。
                            $(".selectwo").html("<option >无</option>")
                            $(".selectwo").attr("disabled","disabled")
                            $(".selectthree").html("<option>无</option>")
                            $(".selectthree").attr("disabled","disabled")
                            
                        }else{
                            for(var i=0;i<data[0].children.length;i++){
                            str1 += '<option value="'+ i +'">'+ data[0].children[i].courseware +'</option>';
                            }
                            $(".selecttwo").html(str1)
                            // 判断并渲染第三个输入框
                            if(data[0].children[0].children == undefined){
                                $(".selectthree").html("<option>无</option>")
                                $(".selectthree").attr("disabled","disabled")
                                
                                return
                            }else{
                                for(var i=0;i<data[0].children[0].children.length;i++){
                                str2 += '<option value="'+ i +'">'+ data[0].children[0].children[i].courseware +'</option>'
                                // console.log(str2);
                                }
                                $(".selectthree").attr("disabled",false)
                                $(".selectthree").html(str2)
                            }

                        }

                    
                        $(".selectone").change(function(){
                            var str1 = ""
                            var str2 = ""
                            oneval = $(this).val()
                            if(data[oneval].children == undefined){
                                // 如果没有第二级就渲染“无”，第三级也渲染无。
                                $(".selecttwo").html("<option>无</option>")
                                $(".selecttwo").attr("disabled","disabled")

                                $(".selectthree").html("<option>无</option>")
                                $(".selectthree").attr("disabled","disabled")
                                // return
                            }else{
                                // 渲染第二个输入框
                                for(var i=0;i<data[oneval].children.length;i++){
                                    if(i ==0){
                                        str1 += '<option value="'+ i +'">'+ data[oneval].children[i].courseware +'</option>'
                                    }else{
                                        str1 += '<option value="'+ i +'">'+ data[oneval].children[i].courseware +'</option>'
                                    } 
                                }
                                $(".selecttwo").attr("disabled",false)
                                $(".selecttwo").html(str1)

                            //    渲染第三个输入框
                                if(data[oneval].children[0].children == undefined){
                                    $(".selectthree").html("<option>无</option>")
                                    $(".selectthree").attr("disabled","disabled")
                                    // console.log("wei",data[oneval].children[0].children);
                                    
                                }else{
                                    for(var i=0;i<data[oneval].children[0].children.length;i++){
                                    str2 += '<option value="'+ i +'">'+ data[oneval].children[0].children[i].courseware +'</option>'
                                    // console.log(str2);
                                    }
                                    $(".selectthree").attr("disabled",false)
                                    $(".selectthree").html(str2)
                                }
                            }                   
                        
                        })
                        // 第二个输入框的事件
                        $(".selecttwo").change(function(){
                            var str2 = ""
                            twoval = $(this).val()
                            // 判断是否存在子一级
                            if(data[oneval].children[twoval].children == undefined){
                                $(".selectthree").html("<option>无</option>")
                                $(".selectthree").attr("disabled","disabled")
                                return
                            }
                            for(var i=0;i<data[oneval].children[twoval].children.length;i++){
                            str2 += '<option value="'+ i +'">'+ data[oneval].children[twoval].children[i].courseware +'</option>'
                            console.log(str2);
                        }
                        
                        $(".selectthree").attr("disabled",false)
                        $(".selectthree").html(str2)
                        
                        
                        console.log('3id',data[oneval].children[twoval].children[0].id);

                        })
                        // $(".selectwo").change()
                        // $(".selectthree").on("change",function(){
                        //     thrval = $(this).val()
                        // })
                        $(".addsection").on("click",function(){
                            // 因为上面的的change事件无法监听选中最后一个option，所以只能重新获取值。
                            var op1 = $(".selectone option:selected").val(); 
                            // console.log(op1);
                            var op2 = $(".selecttwo option:selected").val(); 
                            // console.log(op1);
                            var op3 = $(".selectthree option:selected").val(); 
                            // console.log(op1);
                            if(data[op1].children == undefined ){
                                sectionid = data[op1].id;
                            }else if(data[op1].children[op2].children == undefined ){
                                sectionid = data[op1].children[op2].id
                            }else{
                                sectionid = data[op1].children[op2].children[op3].id
                            }
                            console.log("章节的id",sectionid);
                            console.log("文件的id",fileid);
                            console.log("当前所处的分类页面",clas);
                            
                        
                            // 发送添加课程
                            $("#loadingModal").modal("show")
                            $.ajax({
                                url: HTTP_URL + "Resource/gs_section",
                                type: "post",
                                data: {
                                    zid: sectionid,
                                    id: fileid,
                                    val: clas
                                },
                                dataType: "json",
                                success: function (data) {
                                    console.log(data);
                                
                                    toastr.success("操作成功")
                                    
                                },
                                error: function (e) {
                                    toastr.error("网络开小猜了，请稍后再试！")
                                    console.log(e)
                                },
                                complete: function (xhr, status) {
                                    // 隐藏loading
                                    $("#loadingModal").modal("hide")
                                }
                            })

                        })
                    }else{
                        console.log("列表数据为空");
                        
                    }




                },
                error:function(jqXHR){
                    console.log("发生错误:"+jqXHR.status);
                }
            });
        }
        courseclass(cid,"Resource/set_section")

        function confirmBySelf(content, func,tit) {
            $.confirm({
                confirmButtonClass: "btn-primary",   //设置ok按钮样式
                closeIcon: true,        //对话框右上角关闭
                confirmButton: "确认", //确认按钮标题
                cancelButton: "取消", //取消按钮标题
                title: tit,        //标题
                content: content,        //对话内容
                confirm: function () {
                    //点击确认后做什么
                    func()
                },
                cancel:function () {
                    //点击取消后做什么
                }
            })
        }

        // 获取地址栏后面的信息
        clas = getSearch("class");
        // 根据信息判断要请求哪一页的数据
        if(clas == 1){
            // 要查询的地址
            site = "Resource/textresource"
            // 分页插件
            select_announce(1,"DESC")
            // 渲染页面标题
            $(".tt_content_right_title").text("文本");

        }else if(clas == 2){
            // 要查询的地址
            site = "Resource/photoresource"
            // 分页插件
            select_announce(1,"DESC")
            // 渲染页面标题
            $(".tt_content_right_title").text("图形图像");
        }else if(clas == 3){
            // 要查询的地址
            site = "Resource/audioresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("音频类");
        }else if(clas == 4){
            // 要查询的地址
            site = "Resource/vedioresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("视频类");
        }else if(clas == 5){
            // 要查询的地址
            site = "Resource/cartoonresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("动画类");
        }else if(clas == 6){
            // 要查询的地址
            site = "Resource/dummyresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("虚拟仿真类");
        }else if(clas == 7){
            // 要查询的地址
            site = "Resource/eclassresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("电子课件");
        }else if(clas == 8){
            // 要查询的地址
            site = "Resource/eclassresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("网页类");
        }else if(clas == 9){
            // 要查询的地址
            site = "Resource/ebookresource"
            // 分页插件
            select_announce(1,"DESC")
            $(".tt_content_right_title").text("电子图书/教材");
        }


        // 当单击升序和降序时，更改排序，并且跳转到当前页。
        $(".asc").on("click",function(){
            select_announce(pagedata,"ASC")
        })
        $(".desc").on("click",function(){
            select_announce(pagedata,"DESC")
        })
            // 查询
            //要跳转的页，升序或降序
        function select_announce(pageN,sl) {
            var param = {
                cid: cid,
                sl:sl,
                page: pageN,
            }
            console.log(param);
            // 将页码传到函数外
            pagedata = pageN;
            // 将排序传到外面
            sort = sl;
            // loading显示
            $("#loadingModal").modal("show")
            var CouIntrAjax = $.ajax({
                url: HTTP_URL + site,
                type: "post",
                timeout: 5000,
                dataType: "json",
                // async:false,    //不进行异步刷新
                data: param,
                success: function (data) {
                    // 判断数据是否为空
                    if(data!= false && data != null && data[1] != 0){
                        console.log("文本的数据",data)
                        // console.log(data[0])
                        if (0 == data.length) {
                            // 没有数据，显示提示
                            toastr.error("未查询到可用数据")
                            $("#loadingModal").modal("hide")
                        }
                        var str ;
                        // 只有第一页有添加文件
                        if(pageN == 1){
                            str ='<div data-toggle="modal"  data-target="#myModal2" class="courseicon">\n'+
                                '<div class="add">+</div>\n'+
                                '<div class="addtext">本地添加</div>\n'+
                                '<input id="filebtn" type="file" class="addfile">\n'+
                            '</div>';
                        }else{
                            str = ""
                        }


                        // var str = ""
                        for(var i=0;i<data[0].length;i++){
                            str +='<div href="" class="courseimg">\n'+
                                        '<div class="courseshowbox">\n'+
                                            '<img data-savename="'+ data[0][i].savename +'" class="courseshow"'+ (clas ==2 ? 'src="http://192.168.1.112/lanhong/Application/Home/Public/upload/'+ data[0][i].savename +'"' : 'src="../img/未标题-7.png "' )+' alt="">\n'+
                                            '<div  data-obj="'+ data[0][i].id+'" class="select">\n'+
                                                '<div class="section">添加到章节</div>\n'+
                                                '<div class="delet">删除</div>\n'+
                                                '<div class="update">重命名</div>\n'+
                                                '<div class="down"><a href="http://192.168.1.112/lanhong/index.php/Admin/Amount/excel_user' +'" >下载</a></div>\n'+
                                            '</div>\n'+
                                        '</div>\n'+
                                        '<div class="imgtext" title="'+ data[0][i].name +'">\n'+
                                            data[0][i].name.substring(0, 5) +'\n'+
                                        ' </div>=\n'+
                                    '</div>'
                        }
                        $('.filebox').html(str);

                        // 删除文件
                        $(".delet").on("click",function(){
                            // 获取id
                            var fileid =  $(this).parent().data("obj")
                            // 获取地址栏后面的信息
                            var clas = getSearch("class");
                            var site;

                            // 提示用户要不要修改
                            confirmBySelf('确定删除吗？', function () {
                                // 用户点击确认时
                                //删除文件
                                    
                                if(clas == 1){
                                    // 要删除的地址
                                    site = "Resource/de_text"
                                }else if(clas == 2){
                                    // 要删除的地址
                                    site = "Resource/de_photo"
                                }else if(clas == 3){
                                    // 要删除的地址
                                    site = "Resource/de_audio"
                                }else if(clas == 4){
                                    // 要查询的地址
                                    site = "Resource/de_vedio"
                                }else if(clas == 5){
                                    // 要查询的地址
                                    site = "Resource/de_cartoon"
                                    $(".tt_content_right_title").text("动画类");
                                }else if(clas == 6){
                                    // 要查询的地址
                                    site = "Resource/de_dummy"
                                    $(".tt_content_right_title").text("虚拟仿真类");
                                }else if(clas == 7){
                                    // 要查询的地址
                                    site = "Resource/de_class"
                                    $(".tt_content_right_title").text("电子课件");
                                }else if(clas == 8){
                                    // 要查询的地址
                                    site = "Resource/de_webpage"
                                    $(".tt_content_right_title").text("网页类");
                                }else if(clas == 9){
                                    // 要查询的地址
                                    site = "Resource/de_book"
                                    $(".tt_content_right_title").text("电子图书/教材");
                                }
                                    $.ajax({
                                        type:"post",
                                        url: HTTP_URL+site,
                                        dataType:"json",
                                        data: {id: fileid},
                                        success:function(data){
                                            console.log("鼠标",data);
                                            // 重新渲染页面
                                            select_announce(pageN,sl)
                                        },
                                        error:function(jqXHR){
                                            console.log("发生错误:"+jqXHR.status);
                                        }
                                    });
                            },"提示")
                            // 删除数据的ajax
                        })
                        $(".update").on("click",function(){
                            $("#new_modal").modal("show")
                            // // 获取ID
                            fileid =  $(this).parent().data("obj")
                            // // 修改名称的ajax
                            // ajax(fileid,"Resource/up_text")
                            // //重新渲染
                            // select_announce(pageN,sl)
                        })
                        //修改文件名
                        $(".saveclass").on("click",function(){
                            var id = fileid;
                            
                            var name = $(".addclassname").val() 
                            var upurl ;
                            // var teacher = $(".addclassteacher").val() 
                            if(name == "" ){
                                // console.log("添加的为空");
                                $("#new_modal").modal("hide")
                                return
                            }
                            if(clas == 1){
                            // 添加文件
                            
                                upurl = HTTP_URL+"Resource/up_text"
                            
                            }else if(clas == 2){
                                //图像
                                // 添加文件
                                    
                                upurl = HTTP_URL+"Resource/up_photo"

                            }else if(clas == 3){
                                //音频
                                // 添加文件
                                upurl = HTTP_URL+"Resource/up_audio"
                            }else if(clas == 4){
                                // 视频
                                // 添加文件
                                upurl = HTTP_URL+"Resource/up_vedio"
                            }else if(clas == 5){
                                // 动画
                                // 添加文件
                                upurl = HTTP_URL+"Resource/up_cartoon"                  
                            }else if(clas == 6){
                                // 虚拟仿真
                                // 添加文件
                                upurl = HTTP_URL+"Resource/up_dummy"
                            }else if(clas == 7){
                                // 电子课件
                                // 添加文件
                                upurl = HTTP_URL+"Resource/up_eclass"
                            }else if(clas == 8){
                            //    网页
                            // 添加文件
                                upurl = HTTP_URL+"Resource/up_webpage"
                            }else if(clas == 9){
                                // 图书
                                // 添加文件
                
                                upurl = HTTP_URL+"Resource/up_ebook"
                            }
                            // console.log('页面',clas);
                            // console.log('图片id为',id);
                            // console.log("name",name);
                            // console.log("地址",upurl);

                            $("#loadingModal").modal("show")
                            $.ajax({
                            type:"post",
                            url:upurl,
                            dataType:"json",
                            data: {id: id,name: name},
                            success:function(data){
                                // console.log("班级数据",data);
                                if(0 == data.length){
                                    return;
                                }
                                // $("#loadingModal").modal("hide")
                                $("#new_modal").modal("hide")
                                //刷新页面的js
                                // history.go(0)
                                // 重新渲染页面
                                select_announce(pageN,sl)
                            },
                            error:function(jqXHR){
                                console.log("发生错误:"+jqXHR.status);
                            }
                            });
                        })
                        // 点击添加章节按钮
                        $(".section").on("click",function(){
                            $("#addasection").modal("show")
                            // // 获取ID
                            fileid =  $(this).parent().data("obj")

                            // // 修改名称的ajax
                            // ajax(fileid,"Resource/up_text")
                            // //重新渲染
                            // select_announce(pageN,sl)
                        })



                        console.log(clas);
                        // 如果为音频视频图画类，可以点击跳转页面
                        if(clas ==3 || clas == 4 || clas == 5){

                        }
                        if(clas == 2){

                        }

                      

            

                        


                        //鼠标的移入移出  
                        // for(let i=0;i<data.lis.length;i++){
                        //     $("tbody tr").eq(i).mouseover(function (){  
                        //         console.log();
                        //         $(".mouseovercontent").css({"display":"block"})
                        //         var str =   '<div>查看课程视频得分 '+ data.lis[i].video +' </div>\n'+
                        //                     '<div>参与讨论情况得分 '+ data.lis[i].discuss +' </div>\n'+
                        //                     '<div>提交笔记情况得分 '+ data.lis[i].note +' </div>\n'+
                        //                     '<div>参与提问答疑得分 '+ data.lis[i].quiz +' </div>\n'+
                        //                     '<div>参与考试/测验成绩 '+ data.lis[i].exam +' </div>'
                        //         $(".mouseovercontent").html(str)
                        //     }).mouseout(function (){  
                        //         // $(".content").hide();  
                        //         // console.log("移除",j); 
                        //         $(".mouseovercontent").css({"display":"none"})
                        //     });
                        // }


                        //分页
                        $("#page").bootstrapPaginator({
                            bootstrapMajorVersion: 3,   //bootstrap版本
                            totalPages: data[1],   //总页数
                            numberOfPages: 3,    //分页器每页展示页码数
                            shouldShowPage: true,   //所有的按钮都展示
                            itemTexts: function (type, page, current) {
                                // console.log(type)
                                //设置分页控件每部分的显示文字
                                switch (type) {
                                    case "first":
                                        return "第一页"
                                    case "prev":
                                        return "上一页"
                                    case "next":
                                        return "下一页"
                                    case "last":
                                        return "最后一页"
                                    case "page":
                                        return page
                                    case "jump":
                                        return "跳转"
                                }
                            }, onPageClicked: function(event, originalEvent, type, page) {
                                //点击事件
                                //page表示分页控件当前的页码，用这个页码重新走网络请求，会拿到对应的数据
                                pageNum = page
                                // 查询
                                select_announce(pageNum,sl)
                            }
                        })
                        //  分页结束
                }else{
                    // var addstr ;
                    addstr ='<div data-toggle="modal"  data-target="#myModal2" class="courseicon">\n'+
                                '<div class="add">+</div>\n'+
                                '<div class="addtext">本地添加</div>\n'+
                                '<input id="filebtn" type="file" class="addfile">\n'+
                            '</div>';
                    $('.filebox').html(addstr + "<div>没有数据...</div>");
                    console.log("无资料数据");
                    
                }
                },
                error: function (e) {
                    console.log(e)
                    console.log(e.statusText)
                    if ("timeout" == e.statusText) {
                        // 请求超时，终止请求
                        toastr.warning("请求超时")
                        CouIntrAjax.abort()
                    } else {
                        toastr.error("网络开小差了，请稍后再试！")
                    }
                    $("#loadingModal").modal("hide")
                },
                complete: function (xhr, status) {
                    // 隐藏loading
                    $("#loadingModal").modal("hide")
                }
            })
        }
    })

</script>
</html>